# 要件
[phase 1]
キャラクターのパラメータに体格を追加してUI表示するように
移動のパラメータをUI表示するように

[progress 2025-09-28]
- model/user/ui/pkg 全層に Bld(体格) を追加（JSONキー: Bld）。
- ステータス画面に「体格」を追加表示、移動は既存のまま維持（行を1段追加）。
- マスタ/ユーザJSONへ Bld を追記（例: アイリス=5、ロイド=6、ハヤテ=4）。
- ビルド/テスト準備中（コミット前確認待ち）。

[phase 2]
戦闘を行う際は攻撃速度のパラメータを追加
攻撃速度は基本は速さ。体格より武器の重さが上回る場合その分攻撃速度を下げる
攻撃速度が3以上上回っているユニットは2回攻撃を行うように

[progress 2025-09-28]
- /pkg/game に `AttackSpeed` と `DoubleAdvantage` を追加（AS=Spd-max(0, Wt-Bld)）。
- 実戦ロジック `app.RunBattleRound` に追撃処理を実装（攻→反→追）。
- 反撃可否は射程で判定、追撃は AS 差>=3 の側のみ実行。
- 耐久消費は「攻撃1回ごとに1」へ変更（攻撃側/反撃側とも）。
- 模擬戦 `SimulateBattleCopy` も同ロジックで追撃対応（暫定）。
- ステータスUIに「攻撃速度」を追加表示（先頭装備の重さと体格から算出）。
  - 文字と数値の重なりを解消（ラベル幅に応じて可変マージン）。
  - バトル/模擬戦のサイド情報にも「攻撃速度」を表示（小さめフォントで行間調整）。
  - 戦闘プレビューの左側ベースラインを `uicore.S(460)` に統一し、解像度スケール差での重なりを回避。
  - 攻撃速度の算出ロジックを `adapter.AttackSpeedOf` に一元化し、UI側は同関数を呼び出すのみ。

[phase 3]
現状のバトルシミュレータを廃止して、今のバトルをバトルシミュレータにリネームする。
(機能はそのまま)
バトルシミュレータではシミュレータ内でHPの情報を保持し、ユーザデータへの更新は行わないように
各キャラクターのパラメータから戦闘への遷移はオミット
ユニット一覧からの模擬戦ボタンで新規バトルシミュレータに遷移できるように

[phase 3]
新規バトルシミュレータでは対戦キャラクターをユニット一覧から選択できるように
地形に関しても地形一覧から選択できるように

[phase 4]
バトルシミュレータの戦闘ログ表示で攻撃の結果を攻撃ログと同じ行に出力するように
どちらかのHPが0になった場合、勝利ログを表示するように

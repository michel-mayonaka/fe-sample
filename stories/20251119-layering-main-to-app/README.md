# 20251119-layering-main-to-app — レイヤリング/依存の整理（main→app 移譲）

ステータス: [準備完了]
担当: @tkg-engineer
開始: 2025-11-19 00:22:47 +0900

## 目的・背景
- `cmd/ui_sample/main.go` 付近に残っている入力処理・状態遷移ロジックを `internal/app` 層へ集約し、UI 側を描画＋イベント通知に限定することで、レイヤリングと依存方向を整理する。
- UI からの直接 I/O や責務の混在を解消し、将来的な機能追加やリファクタリングを行いやすくする。

## スコープ（成果）
- main/app 間でどの責務をどちらに持たせるかの方針を整理し、理想的な依存方向を文書化する。
- `internal/app` に集約すべき入力/状態遷移ロジックの範囲を洗い出し、移譲案（構造体/インタフェース/関数単位）をまとめる。
- `config` や Repo、Usecase との依存関係を見直し、パスや初期化処理の統一方針を検討する。

## 受け入れ基準（Definition of Done）
- [ ] 現状の main/app レイヤリングと依存関係が整理されたメモがある。
- [ ] 入力処理・状態遷移を `internal/app` へ移譲する際の方針と、おおまかな分担（責務一覧）が決まっている。
- [ ] 実装フェーズに向けた移行ステップ（フェーズ分割や影響範囲）が文章として明文化されている（実装自体は別ストーリーで対応してもよい）。

## 工程（サブタスク）
- [ ] 現状調査: main と internal/app の責務/依存の棚卸し — `stories/20251119-layering-main-to-app/tasks/01_audit-main-app.md`
- [ ] レイヤリング方針の整理: 望ましい責務分担と依存方向の設計 — `stories/20251119-layering-main-to-app/tasks/02_design-layering.md`
- [ ] 移行ステップ案と後続タスク（実装ストーリー/Backlog）の整理 — `stories/20251119-layering-main-to-app/tasks/03_migration-plan-and-backlog.md`

## 計画（目安）
- 見積: 1〜2 セッション
- マイルストン: M1: 現状調査 / M2: 方針案ドラフト / M3: 移行ステップ整理

## 進捗・決定事項（ログ）
- 2025-11-19 00:22:47 +0900: ストーリー作成（discovery: 2025-09-27-migrated-11 から昇格）
- 2025-11-19 00:27:54 +0900: README とサブタスクを整備し、main→app 移譲の方針検討の下準備が整ったためステータスを[準備完了]へ更新。

## リスク・懸念
- レイヤリング変更に伴う一時的なコンパイルエラーやテスト修正コスト。
- 既存の設計ドキュメントとの齟齬が生じる可能性。

## 関連
- PR: #
- Issue: #
- Docs: `docs/ARCHITECTURE.md`, `docs/workflows/stories.md`

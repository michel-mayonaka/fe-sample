# 20251117-webgl-dark-screen — WebGL暗転不具合の調査

ステータス: [完了]
担当: @kyosuke_tsubo
開始: 2025-11-17 01:13:08 +0900

## 目的・背景
- GitHub Actions で生成した WebGL ビルドを実行すると、画面が暗転したまま進行しない不具合の原因を特定する。
- ローカルビルドと WebGL ビルドの差異（ビルド設定/アセットパス/ブラウザ側制約など）を整理し、今後のデバッグや再発防止に役立つ知見を残す。

## スコープ（成果）
- 対象となる WebGL ビルド（Actions のジョブや gh-pages）の再現手順が明文化されている。
- ブラウザコンソール/Network などから、暗転の直接原因候補が列挙されている（少なくとも 1 つは原因を特定）。
- 必要であれば、原因ごとの対策案（設定変更・コード側のガード・ログ追加・ワークフロー修正など）を Backlog/別ストーリーに切り出す。

## 受け入れ基準（Definition of Done）
- [x] 暗転が再現する WebGL ビルドの入手方法と実行手順が Story またはタスクに記載されている。
- [x] ブラウザ側で確認したエラー/警告/ネットワーク状況などがログとして残っている。
- [x] 少なくとも「今見えている暗転」の直接原因が 1 つ以上特定され、対策の方向性（すぐやる/後回し/別 Story 化）が決まっている。
- [x] 必要な場合、後続の修正用ストーリー or Backlog エントリが作成されている。

## 工程（サブタスク）
- [x] 再現環境の整理とビルド確認（リンク: `stories/20251117-webgl-dark-screen/tasks/01_reproduce.md`）
- [x] ブラウザログ/ネットワークログの採取と原因候補の洗い出し（リンク: `stories/20251117-webgl-dark-screen/tasks/02_investigate_logs.md`）
- [x] 対策方針の整理と後続タスク（Backlog/Story）の切り出し（リンク: `stories/20251117-webgl-dark-screen/tasks/03_followups.md`）

## 計画（目安）
- 見積: X 時間 / セッション
- マイルストン: M1 / M2 / M3

## 進捗・決定事項（ログ）
- 2025-11-17 01:13:08 +0900: ストーリー作成
- 2025-11-17 01:20:00 +0900: WebGL ではユーザ永続化を行わない「デモ版」とし、ユーザRepo初期化失敗時も panic せずサンプルユニットで起動するように `NewUIAppGame` を更新。ユーザ永続化の将来方針は docs/KNOWLEDGE/data/db-notes.md に記載。
- 2025-11-17 01:44:38 +0900: WebGL ビルドをローカル環境で再確認し、暗転が発生せず期待どおり起動することを確認。
- 2025-11-17 01:46:41 +0900: アーカイブ（finish へ移動）

## リスク・懸念
- GitHub Actions 上のビルド環境やブラウザ依存の問題で、再現性が限定される可能性がある。
- 原因が Ebiten ランタイムやブラウザの仕様に強く依存している場合、短期的にはワークアラウンドに留まる可能性がある。

## 関連
- PR: #
- Issue: #
- Docs: `.github/workflows/*`, `web/index.html`

- 2025-11-17 01:45:30 +0900: アーカイブ（finish へ移動）

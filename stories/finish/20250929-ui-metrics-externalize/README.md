# 20250929-ui-metrics-externalize — UI 表示位置・サイズのメトリクス外部化

ステータス: [完了]
担当: @tkg-engineer

## 目的・背景
- 画面上の座標・サイズ等の UI メトリクスを外部ファイル（JSON 等）から読み込み可能にし、解像度差/レイアウト改修をデータで調整できるようにする。
- 現状の散在するハードコードを集約し、探索性と再利用性を高める。

## スコープ（成果）
- メトリクス定義スキーマの策定（キー命名・単位・基準解像度）。
- ローダ/フォールバック実装（設定未提供時は既定値で動作）。
- 代表画面（インベントリ一覧）での適用検証（見た目維持）。
- ドキュメント更新（ARCHITECTURE/API/NAMING の整合メモ）。

## 受け入れ基準（Definition of Done）
- [ ] `make mcp` がグリーン（vet/build/lint/test）
- [ ] 代表画面が外部メトリクス経由で描画され、既存見た目と実質同等
- [ ] 設定不在時は既定値で正常動作（パニックなし）
- [ ] ドキュメント（docs/ARCHITECTURE.md, docs/API.md）に反映

## 工程（サブタスク）
- [x] 01: 現状調査と対象画面決定（`tasks/01_discovery.md`）
- [x] 02: スキーマ設計とサンプル定義（`tasks/02_schema.md`）
- [x] 03: ローダ実装とDI配線（`tasks/03_loader_wiring.md`）
- [ ] 04: 代表画面への適用（インベントリ一覧）（`tasks/04_apply_inventory_list.md`）
- [x] 05: ドキュメント更新と簡易テスト（`tasks/05_docs_tests.md`）
    - docs 反映済（ARCHITECTURE/API）。ローダ/適用の最小テストを追加。

## 計画（目安）
- 見積: 3〜5 時間 / 1〜2 セッション
- マイルストン: M1=スキーマ確定, M2=ローダ実装, M3=適用/検証完了

## 進捗・決定事項（ログ）
- 2025-09-29: ストーリー作成（Backlog から昇格）
- 2025-09-29: 調査/スキーマ/ローダ/DI を実施し、既定JSONを追加。`ApplyMetrics` で起動時に反映される構造に変更。
- 2025-09-29: 固定オフセットをスキーマ昇格し、インベントリ一覧（武器/アイテム）へ適用。
- 2025-09-29: ステータス画面/模擬戦の主要オフセットを外部化（status/sim/terrain）。

## リスク・懸念
- 既存 UI の微妙なズレ発生（基準解像度/スケールの扱い）
- スキーマ肥大化による運用コスト増
- ロード失敗時のフォールバック経路の複雑化

## 関連
- PR: #
- Issue: #
- Docs: `docs/ARCHITECTURE.md`, `docs/API.md`, `docs/NAMING.md`, `stories/BACKLOG.md`

<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ui_sample — WebGL (WASM) Demo</title>
    <style>
      html, body { height: 100%; margin: 0; background: #111; color: #ddd; font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, "Hiragino Kaku Gothic ProN", Meiryo, sans-serif; }
      #app { display: flex; align-items: center; justify-content: center; height: 100%; }
      #msg { position: fixed; left: 12px; bottom: 12px; opacity: 0.8; font-size: 12px; }
      canvas { outline: none; }
      a { color: #8ec7ff; }
    </style>
  </head>
  <body>
    <div id="app">
      <noscript>このデモを利用するには JavaScript を有効にしてください。</noscript>
    </div>
    <div id="msg">起動しない場合: 1) リロード 2) 別ブラウザ（Chrome/Firefox/Safari）をお試しください。iOS は初回タップが必要な場合があります。</div>

    <script src="wasm_exec.js"></script>
    <script>
      // Go ランタイム
      const go = new Go();

      async function loadWasm() {
        const wasmURL = 'ui_sample.wasm';
        try {
          if ('instantiateStreaming' in WebAssembly) {
            const r = await WebAssembly.instantiateStreaming(fetch(wasmURL), go.importObject);
            go.run(r.instance);
          } else {
            const buf = await fetch(wasmURL).then(res => res.arrayBuffer());
            const r = await WebAssembly.instantiate(buf, go.importObject);
            go.run(r.instance);
          }
        } catch (e) {
          const el = document.getElementById('app');
          el.innerHTML = '<div style="padding:16px;max-width:720px;">'+
            '<h2>起動に失敗しました</h2>'+
            '<p>お使いの環境が WebAssembly / WebGL に対応していない可能性があります。</p>'+
            '<ul><li>Chrome / Firefox / Safari の最新バージョンをお試しください。</li>'+
            '<li>コンソールのエラー内容をご確認ください。</li></ul>'+
            '<p style="font-size:12px;opacity:.7">'+ e +'</p>'+
            '</div>';
          console.error(e);
        }
      }
      loadWasm();
    </script>
  </body>
  </html>

